<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  
  <title>contacto</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
<!--captha -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
  
  <style>           
      html, body {
      padding: 1% 1% 1% 1%;
      margin: 1% 0% -5% 0%;
      height: 100%;
      width: 100%;
      box-sizing: border-box;
       background-color: #e0e0e0;} 
   #f { background:#e3f2fd ;
        margin: 1% 5% 5% 5%;
        padding: 4% 2% 2% 0%;
        border-radius: 11%;
        height: auto;
   }
   #i{background:#e0e0e0 ;
        margin: 1% 1% 1% 1%;
        padding: 1% 1% 1% 1%;}

</style>

</head>
<body>
  <div id="f"> 
<div class="container-fluid ">
  <div class="row">
   <div class="col-4 "></div>
    <div class="col-4 rounded-3 bg-primary text-center text-white" style="word-wrap: break-word; overflow-wrap: break-word;"> CONTACTO
    </div>
    <div class="col-4 "></div>
  </div>
</div>

<div class="container-fluid mt-2">
    <div class="row">
        <div class="col-6 rounded-4 mt-2 bg-primary text-center text-white p-1" style="margin-left: 25%;">
            <label for="nombreApellido" class="form-label">NOMBRE Y APELLIDO</label>
            <input type="text" class="form-control rounded-4" id="nombreApellido" placeholder="Nombre Y Apellido" name="nombre_apellido">
        </div>
    </div>

    <div class="col-6 rounded-4 mt-2 bg-primary text-center text-white p-1" style="margin-left: 25%;">
        <label for="telUsuario" class="form-label">TEL</label>
        <input type="tel" class="form-control rounded-4" id="telUsuario" placeholder="tel" name="telefono">
    </div>

    <div class="col-6 rounded-4 bg-primary text-center mt-2 text-white p-1" style="margin-left: 25%;">
        <label for="tipoCliente" class="form-label">CLIENTE</label>
        <input type="text" class="form-control rounded-4" id="tipoCliente" placeholder="cliente" name="cliente">
    </div>

    <div class="col-6 rounded-4 bg-primary mt-2 text-center text-white p-1" style="margin-left: 25%;">
        <label for="direccionUsuario" class="form-label">DIRECCION</label>
        <input type="text" class="form-control rounded-4" id="direccionUsuario" placeholder="Direccion, calles,localidad, etc" name="direccion">
    </div>

    <div class="col-6 rounded-4 bg-primary text-center mt-2 text-white p-1" style="margin-left: 25%;">
        <label for="correoUsuario" class="form-label">EMAIL</label>
        <input type="email" class="form-control rounded-4" id="correoUsuario" name="email" placeholder="name@example.com">
    </div>

    <div class="col-10 rounded-4 bg-primary text-center mt-2 text-white p-1" style="margin-left: 8%;">
        <label for="asuntoMensaje" class="form-label">ASUNTO</label>
        <textarea class="form-control rounded-5" id="asuntoMensaje" name="asunto" placeholder="Escribe tu mensaje" rows="3"></textarea>
    </div>

    <div class="col-6 rounded-4 mt-4" style="margin-left: 8%;">
        <div class="g-recaptcha" data-sitekey="6LemOPYrAAAAAMGLt1Gs1XLSL-63bi7xMJHGvGuR"></div>
    </div>

    <button type="button" style="margin-left: 8%" class="btn btn-primary btn-lg mt-4" id="enviarDatosBtn">ENVIAR</button>
</div>
<div id="i"> 
</div>
<script>
// Tu URL sigue siendo la misma:
const URL_DEL_SERVIDOR = 'https://script.google.com/macros/s/AKfycbyynjHG6QiTqOafvWWXQ4LrAtaepNexr7Cv1AJh1Rn_x6OTz84Tpju_mg3CD9thT8DM/exec'; 

// 1. Enlazar el bot√≥n de env√≠o
document.getElementById('enviarDatosBtn').addEventListener('click', enviarDatosFormulario);

async function enviarDatosFormulario() {
    
    // 2. VERIFICACI√ìN DE RECAPTCHA (Frontend)
    const recaptchaToken = grecaptcha.getResponse();

    if (!recaptchaToken) {
        alert('Por favor, marca la casilla "No soy un robot". ü§ñ');
        return; 
    }
    
    // 3. RECOLECCI√ìN DE DATOS
    const camposFormulario = document.querySelectorAll('input[name], textarea[name]');
    const datosParaEnviar = {};

    camposFormulario.forEach(campo => {
        datosParaEnviar[campo.name] = campo.value;
    });

    // 4. ADJUNTAR TOKEN
    datosParaEnviar['g-recaptcha-response'] = recaptchaToken;
    
    // 5. CONVERTIR DATOS A QUERY STRING (Formato que Apps Script acepta para evitar CORS)
    const queryString = Object.keys(datosParaEnviar).map(key => {
        return encodeURIComponent(key) + '=' + encodeURIComponent(datosParaEnviar[key]);
    }).join('&');

    // 6. ENV√çO (Usando la URL con el query string)
    try {
        // Usamos GET con los par√°metros, lo cual es compatible con Apps Script sin CORS.
        const respuesta = await fetch(`${URL_DEL_SERVIDOR}?${queryString}`, {
            method: 'GET' 
            // NOTA: Tambi√©n puedes usar fetch(URL_DEL_SERVIDOR, { method: 'POST', body: new FormData(tuFormulario) }) 
            // pero el m√©todo GET con query string es el m√°s simple y compatible aqu√≠.
        });

        // La respuesta del Apps Script es ahora texto plano JSON.
        const resultadoTexto = await respuesta.text(); 
        const resultado = JSON.parse(resultadoTexto);

        if (resultado.success) {
            alert('¬°Mensaje enviado y guardado con √©xito! üéâ');
        } else {
            console.error('Error:', resultado.message);
            alert(`Error: ${resultado.message}`);
        }
    } catch (error) {
        console.error('Error de red durante la petici√≥n fetch:', error);
        alert('Error: No se pudo conectar con el servidor.');
    } finally {
        grecaptcha.reset(); 
    }
}
</script>
</script>
</body>
</html>